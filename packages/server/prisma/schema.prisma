// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       String  @id @default(uuid())
  name     String  @db.VarChar(255)
  surname  String? @db.VarChar(255)
  email    String  @unique @db.VarChar(255)
  password String  @db.VarChar(255)
  phone    String  @unique @db.VarChar(255)

  InstitutionManager InstitutionManager[]
  Professor          Professor[]

  @@map("users")
}

model Institution {
  id    String @id @default(uuid())
  name  String @db.VarChar(255)
  cnpj  String @unique @db.VarChar(255)
  phone String @unique @db.VarChar(255)

  InstitutionManager InstitutionManager[]
  Professor          Professor[]

  @@map("institutions")
}

model InstitutionManager {
  id            String @id @default(uuid())
  userId        String @map("user_id")
  institutionId String @unique @map("institution_id")

  user        User        @relation(fields: [userId], references: [id])
  institution Institution @relation(fields: [institutionId], references: [id])

  @@map("institution_managers")
}

model Professor {
  id            String @id @default(uuid())
  userId        String @map("user_id")
  institutionId String @map("institution_id")

  user        User        @relation(fields: [userId], references: [id])
  institution Institution @relation(fields: [institutionId], references: [id])

  @@unique([userId, institutionId])

  @@map("professors")
}
